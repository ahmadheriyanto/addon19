<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- Inherit the QWeb template stock.stock_picking_type_kanban and insert a status Ã— priority table -->
  <template id="stock_picking_type_kanban_status_priority" inherit_id="stock.stock_picking_type_kanban" priority="15">
    <!-- Fallback: insert before first <div> in the parent template -->
    <xpath expr="(//div)[1]" position="before">
      <div class="o_dashboard_status_priority card" style="margin-bottom:8px;">
        <t t-set="stats" t-value="request.env['stock.picking.dashboard'].sudo().get_picking_status_priority_stats()"/>
        <div class="o_dashboard_title" style="padding:8px 12px;">
          <h4 style="margin:0;">Pick</h4>
          <small t-esc="request.env.company.name or ''"/>
        </div>
        <div class="o_dashboard_table" style="padding:8px;background:#000;color:#fff;border-radius:4px;">
          <table class="table table-sm" style="width:100%;color:#fff;">
            <thead>
              <tr>
                <th style="text-align:left;">&#160;</th>
                <t t-foreach="stats['priorities']" t-as="p">
                  <th style="text-align:center;" t-esc="p"/>
                </t>
                <th style="text-align:center;">Total</th>
              </tr>
            </thead>
            <tbody>
              <t t-foreach="stats['statuses']" t-as="row">
                <tr>
                  <td style="text-align:left; font-weight:600;" t-esc="row['label']"/>
                  <t t-foreach="stats['priorities']" t-as="p_label">
                    <td style="text-align:center;" t-esc="row['by_priority'].get(p_label, 0)"/>
                  </t>
                  <td style="text-align:center;" t-esc="row['total']"/>
                </tr>
              </t>
            </tbody>
            <tfoot>
              <tr style="font-weight:700;">
                <td style="text-align:left;">Total</td>
                <t t-foreach="stats['priorities']" t-as="p_label">
                  <td style="text-align:center;" t-esc="sum([r['by_priority'].get(p_label,0) for r in stats['statuses']])"/>
                </t>
                <td style="text-align:center;" t-esc="stats['total']"/>
              </tr>
            </tfoot>
          </table>
        </div>
      </div>
    </xpath>
  </template>
</odoo>